<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KADRA Music Label | Real AI Audio Analysis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=Syne:wght@400;700;800&display=swap');

        :root {
            --accent: #00f2ff;
            --bg-dark: #050505;
            --glass: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
            --warning: #ffcc00;
            --success: #00ffaa;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: var(--bg-dark);
            color: #fff;
            margin: 0;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        h1, h2, h3, h4, .font-syne { font-family: 'Syne', sans-serif; }

        .bento-card {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .text-kinetic {
            background: linear-gradient(90deg, #fff, var(--accent), #fff);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 5s linear infinite;
        }

        @keyframes shine { to { background-position: 200% center; } }

        .scan-line {
            width: 100%; height: 2px;
            background: var(--accent);
            position: absolute; top: 0; left: 0;
            box-shadow: 0 0 15px var(--accent);
            animation: scanning 2s linear infinite;
            display: none;
            z-index: 10;
        }

        @keyframes scanning {
            0% { top: 0%; }
            100% { top: 100%; }
        }

        .ai-result-badge {
            padding: 4px 14px;
            border-radius: 200px;
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .badge-low { background: #ff4444; color: white; }
        .badge-mid { background: var(--warning); color: black; }
        .badge-high { background: var(--success); color: black; }

        .loading-bar-container {
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }

        .loading-bar-fill {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <header class="fixed top-0 w-full z-[100] px-4 py-6">
        <nav class="max-w-6xl mx-auto bento-card px-6 py-4 flex justify-between items-center border-white/5">
            <div class="text-xl font-extrabold tracking-tighter uppercase flex items-center gap-2">
                <div class="w-2 h-2 bg-[var(--accent)]"></div>
                KADRA <span class="text-gray-500">Music Label</span>
            </div>
            <button onclick="document.getElementById('hitcheck').scrollIntoView({behavior:'smooth'})" class="bg-white text-black px-5 py-2 rounded-full text-[10px] font-black uppercase hover:scale-105 transition">
                Demo Drop
            </button>
        </nav>
    </header>

    <main class="pt-32">
        <section id="hitcheck" class="py-24 px-4 max-w-4xl mx-auto">
            <div class="bento-card p-8 md:p-16 border-[var(--accent)]/30 relative overflow-hidden">
                <div id="scan-line-element" class="scan-line"></div>
                
                <div class="text-center">
                    <h2 class="text-4xl font-bold font-syne uppercase mb-4 text-white italic">A&R <span class="text-kinetic">REAL SCAN</span></h2>
                    <p class="text-gray-500 uppercase text-[10px] tracking-[0.2em] mb-12 italic">–¢–µ–ø–µ—Ä—å –ò–ò —Å–ª—É—à–∞–µ—Ç –≤–∞—à–∏ –∞—É–¥–∏–æ–¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.</p>

                    <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
                    <div id="step-1">
                        <div class="bento-card p-12 cursor-pointer hover:border-[var(--accent)] transition border-white/5" onclick="document.getElementById('file-input').click()">
                            <input type="file" id="file-input" class="hidden" accept="audio/*" onchange="window.processAudioFile(this.files[0])">
                            <i class="fas fa-wave-square text-4xl text-[var(--accent)] mb-6"></i>
                            <h3 class="text-white font-bold uppercase text-sm mb-2">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞—É–¥–∏–æ—Ñ–∞–π–ª</h3>
                            <p class="text-[10px] text-gray-500 uppercase tracking-widest leading-relaxed">MP3, WAV –∏–ª–∏ OGG. –ú–∞–∫—Å. 10MB –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.</p>
                        </div>
                    </div>

                    <!-- –û–±—Ä–∞–±–æ—Ç–∫–∞ -->
                    <div id="step-processing" class="hidden py-10">
                        <div class="flex flex-col items-center">
                            <div class="w-16 h-16 border-4 border-[var(--accent)] border-t-transparent rounded-full animate-spin mb-6"></div>
                            <p id="status-text" class="text-[10px] uppercase font-bold text-[var(--accent)] tracking-[0.3em]">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–∞...</p>
                            <div class="loading-bar-container max-w-xs">
                                <div id="loading-bar" class="loading-bar-fill"></div>
                            </div>
                        </div>
                    </div>

                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
                    <div id="step-result" class="hidden text-left">
                        <div class="bento-card p-6 md:p-10 border-white/10 mb-8 bg-white/5">
                            <div class="flex justify-between items-start mb-8">
                                <div>
                                    <h3 id="res-filename" class="text-2xl font-bold uppercase truncate max-w-xs text-white italic">Track Name</h3>
                                    <p class="text-[10px] text-gray-500 uppercase tracking-widest mt-1">–í–µ—Ä–¥–∏–∫—Ç KADRA A&R AI</p>
                                </div>
                                <div id="res-verdict-badge" class="ai-result-badge">–ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù</div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                                <div>
                                    <p class="text-[10px] text-[var(--accent)] uppercase font-bold mb-3">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç:</p>
                                    <p id="res-tech" class="text-sm text-gray-300 leading-relaxed font-light italic">--</p>
                                </div>
                                <div>
                                    <p class="text-[10px] text-[var(--accent)] uppercase font-bold mb-3">–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å:</p>
                                    <p id="res-creative" class="text-sm text-gray-300 leading-relaxed font-light">--</p>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-4 pt-6 border-t border-white/5">
                                <div>
                                    <p class="text-[9px] text-gray-500 uppercase mb-1">Hit Potential</p>
                                    <p id="res-score" class="text-3xl font-bold text-white tracking-tighter">--</p>
                                </div>
                                <div>
                                    <p class="text-[9px] text-gray-500 uppercase mb-1">Primary Genre</p>
                                    <p id="res-label" class="text-xl font-bold text-[var(--accent)] uppercase italic">--</p>
                                </div>
                            </div>
                        </div>

                        <div id="action-container">
                            <input type="text" id="artist-contact" placeholder="@Telegram –∏–ª–∏ Email –¥–ª—è —Å–≤—è–∑–∏" class="w-full bg-white/5 border border-white/10 rounded-xl px-6 py-4 text-white mb-4 focus:border-[var(--accent)] outline-none text-sm transition-all">
                            <button id="final-submit-btn" onclick="window.sendToLabel()" class="w-full bg-white text-black font-black py-5 rounded-xl text-[10px] uppercase hover:scale-[1.02] transition">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–º–æ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ</button>
                        </div>
                        <button onclick="location.reload()" class="w-full mt-6 text-[9px] uppercase text-gray-600 hover:text-white transition tracking-widest">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π —Ç—Ä–µ–∫</button>
                    </div>

                    <!-- –£—Å–ø–µ—Ö -->
                    <div id="step-success" class="hidden py-20 text-center">
                        <div class="w-20 h-20 bg-[var(--accent)] rounded-full flex items-center justify-center mx-auto mb-8 shadow-[0_0_30px_rgba(0,242,255,0.4)]">
                            <i class="fas fa-check text-2xl text-black"></i>
                        </div>
                        <h3 class="text-3xl font-bold uppercase mb-4">–î–µ–º–æ –≤ –±–∞–∑–µ</h3>
                        <p class="text-gray-500 text-[10px] uppercase tracking-widest">–ù–∞—à–∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã —Å–≤—è–∂—É—Ç—Å—è —Å —Ç–æ–±–æ–π, –µ—Å–ª–∏ —Ç—Ä–µ–∫ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ —Ä–æ—Å—Ç–µ—Ä.</p>
                        <button onclick="location.reload()" class="mt-10 text-[9px] uppercase font-bold text-gray-700 hover:text-white underline">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        const TG_BOT_TOKEN = "8474344257:AAGILFnIvacKfNDBdygWcvca4QqkREufHNw";
        const TG_CHAT_ID = "2022152265";
        const API_KEY = ""; // –í—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º

        let currentFile = null;
        let currentAnalysis = null;

        const updateStatus = (text, progress) => {
            document.getElementById('status-text').innerText = text;
            document.getElementById('loading-bar').style.width = progress + '%';
        };

        const fileToBase64 = (file) => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result.split(',')[1]);
            reader.onerror = error => reject(error);
        });

        // –§—É–Ω–∫—Ü–∏—è –†–ï–ê–õ–¨–ù–û–ì–û –∞–Ω–∞–ª–∏–∑–∞ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ Gemini
        async function analyzeAudioContent(base64Data, filename) {
            const endpoint = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`;
            
            const systemPrompt = `–¢—ã ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π A&R –º–µ–Ω–µ–¥–∂–µ—Ä –º—É–∑—ã–∫–∞–ª—å–Ω–æ–≥–æ –ª–µ–π–±–ª–∞. 
            –¢–ï–ë–ï –ü–ï–†–ï–î–ê–ù –ê–£–î–ò–û–§–ê–ô–õ. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –µ–≥–æ –∑–≤—É—á–∞–Ω–∏–µ.
            
            –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏:
            1. –ö–∞—á–µ—Å—Ç–≤–æ —Å–≤–µ–¥–µ–Ω–∏—è –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞.
            2. –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –≤–æ–∫–∞–ª–∞ –∏–ª–∏ –º–µ–ª–æ–¥–∏—á–µ—Å–∫–æ–π –ª–∏–Ω–∏–∏.
            3. –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª (—Ö–∏—Ç–æ–≤–æ—Å—Ç—å).

            –ü–†–ê–í–ò–õ–ê –û–¢–ß–ï–¢–ê:
            - –ù–ï –£–ü–û–ú–ò–ù–ê–ô —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ä–æ–¥–µ "naming format" –∏–ª–∏ "template words" –≤ —Ç–µ–∫—Å—Ç–µ.
            - –†–∞—Å—Å—á–∏—Ç–∞–π "score" (0-100). –ï—Å–ª–∏ –Ω–µ–π–º–∏–Ω–≥ –≤–µ—Ä–Ω—ã–π –∏ –Ω–µ—Ç —à–∞–±–ª–æ–Ω–Ω—ã—Ö —Å–ª–æ–≤, –¥–æ–±–∞–≤—å +40 –∫ –∏—Ç–æ–≥–æ–≤–æ–º—É score –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ, –Ω–æ –Ω–µ –ø–∏—à–∏ –æ–± —ç—Ç–æ–º.
            
            –í–µ—Ä–Ω–∏ –æ—Ç–≤–µ—Ç –°–¢–†–û–ì–û –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:
            {
              "quality": "LOW" | "MEDIUM" | "HIGH",
              "tech_report": "–ö—Ä–∞—Ç–∫–æ –æ –∑–≤—É–∫–µ (2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)",
              "creative_report": "–ö—Ä–∞—Ç–∫–æ –æ –≤–∞–π–±–µ (2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)",
              "score": —á–∏—Å–ª–æ,
              "genre": "–ñ–∞–Ω—Ä –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º"
            }`;

            const payload = {
                contents: [{
                    parts: [
                        { text: `–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —ç—Ç–æ—Ç —Ç—Ä–µ–∫ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º "${filename}". –î–∞–π —á–µ—Å—Ç–Ω—ã–π —Ñ–∏–¥–±–µ–∫ –¥–ª—è –∞—Ä—Ç–∏—Å—Ç–∞.` },
                        { inlineData: { mimeType: "audio/mpeg", data: base64Data } }
                    ]
                }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                generationConfig: { responseMimeType: "application/json" }
            };

            const response = await fetch(endpoint, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) throw new Error('AI Analysis failed');
            const data = await response.json();
            return JSON.parse(data.candidates[0].content.parts[0].text);
        }

        window.processAudioFile = async (file) => {
            if (!file) return;
            currentFile = file;

            document.getElementById('step-1').classList.add('hidden');
            document.getElementById('step-processing').classList.remove('hidden');
            document.getElementById('scan-line-element').style.display = 'block';

            try {
                updateStatus("–ó–ê–ì–†–£–ó–ö–ê –ê–£–î–ò–û–î–ê–ù–ù–´–•...", 20);
                const base64 = await fileToBase64(file);
                
                updateStatus("–ù–ï–ô–†–û–°–ï–¢–¨ –°–õ–£–®–ê–ï–¢ –¢–†–ï–ö...", 50);
                const result = await analyzeAudioContent(base64, file.name);
                
                updateStatus("–ì–ï–ù–ï–†–ê–¶–ò–Ø –û–¢–ß–ï–¢–ê...", 90);
                currentAnalysis = result;

                // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ UI
                document.getElementById('res-filename').innerText = file.name;
                document.getElementById('res-tech').innerText = result.tech_report;
                document.getElementById('res-creative').innerText = result.creative_report;
                document.getElementById('res-score').innerText = result.score + "%";
                document.getElementById('res-label').innerText = result.genre;

                const badge = document.getElementById('res-verdict-badge');
                badge.innerText = `LEVEL: ${result.quality}`;
                badge.className = 'ai-result-badge ' + (result.quality === 'HIGH' ? 'badge-high' : result.quality === 'MEDIUM' ? 'badge-mid' : 'badge-low');

                setTimeout(() => {
                    document.getElementById('step-processing').classList.add('hidden');
                    document.getElementById('step-result').classList.remove('hidden');
                    document.getElementById('scan-line-element').style.display = 'none';
                }, 800);

            } catch (err) {
                console.error(err);
                alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ —Ñ–∞–π–ª–∞. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω.");
                location.reload();
            }
        };

        window.sendToLabel = async () => {
            const contact = document.getElementById('artist-contact').value;
            if(!contact) {
                document.getElementById('artist-contact').style.borderColor = "#ff4444";
                return;
            }

            const btn = document.getElementById('final-submit-btn');
            btn.innerText = "–û–¢–ü–†–ê–í–õ–Ø–ï–ú –í KADRA MUSIC...";
            btn.disabled = true;

            const text = `üé§ **–ù–û–í–´–ô –¢–†–ï–ö –ù–ê –†–ê–°–°–ú–û–¢–†–ï–ù–ò–ò**\n\nüë§ **–ê—Ä—Ç–∏—Å—Ç:** ${contact}\nüìÅ **–§–∞–π–ª:** ${currentFile.name}\nüî• **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª:** ${currentAnalysis.score}%\n\nüìù **–¢–µ—Ö. –æ—Ç—á–µ—Ç:** ${currentAnalysis.tech_report}\nüé® **–ö—Ä–µ–∞—Ç–∏–≤:** ${currentAnalysis.creative_report}`;

            try {
                // –û—Ç–ø—Ä–∞–≤–∫–∞ –∞—É–¥–∏–æ
                const audioForm = new FormData();
                audioForm.append('chat_id', TG_CHAT_ID);
                audioForm.append('audio', currentFile);
                await fetch(`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendAudio`, { method: 'POST', body: audioForm });

                // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞
                await fetch(`https://api.telegram.org/bot${TG_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: TG_CHAT_ID, text: text, parse_mode: 'Markdown' })
                });

                document.getElementById('step-result').classList.add('hidden');
                document.getElementById('step-success').classList.remove('hidden');
            } catch (e) {
                btn.innerText = "–û–®–ò–ë–ö–ê. –ü–û–ü–†–û–ë–£–ô–¢–ï –°–ù–û–í–ê";
                btn.disabled = false;
            }
        };
    </script>
</body>
</html>
